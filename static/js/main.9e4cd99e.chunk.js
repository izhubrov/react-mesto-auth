(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{16:function(e,t,a){},38:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),s=a(19),i=a.n(s),o=a(8),r=(a(16),a(24)),u=a(10),p=a(2),l=a(3),_=a.p+"static/media/headerlogo.bbe2a6ea.svg",b=a(0);var d=function(e){var t=e.isLoggedIn,a=e.userEmail,n=e.onSignOut,s=e.isLoading,i=Object(l.h)(),r="/sign-in"===i.pathname,u="/"===i.pathname,d=c.a.useState(!1),j=Object(p.a)(d,2),h=j[0],m=j[1];return Object(b.jsxs)("header",{className:"header ".concat(h?"":"page__container"," ").concat(h?"header_columned":""),children:[Object(b.jsxs)("div",{className:"header__logo-container ".concat(h?"header__logo-container_type_column":""),children:[Object(b.jsx)("img",{className:"header__logo appear",src:_,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u0441\u0430\u0439\u0442\u0430 \u0441 \u043d\u0430\u0434\u043f\u0438\u0441\u044c\u044e \u041c\u0435\u0441\u0442\u043e \u0420\u043e\u0441\u0441\u0438\u044f \u0430\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u0438\u043c\u0438 \u0431\u0443\u043a\u0432\u0430\u043c\u0438"}),Object(b.jsx)("button",{onClick:function(){m(!1)},type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043c\u0435\u043d\u044e",className:"header__btn-close ".concat(h?"header__btn-close_type_active":"")})]}),Object(b.jsxs)("div",{onClick:function(){m(!0)},className:"header__btn-menu ".concat(!t||h?"header__btn-menu_type_inactive":""),children:[Object(b.jsx)("div",{className:"header__burger-line"}),Object(b.jsx)("div",{className:"header__burger-line"}),Object(b.jsx)("div",{className:"header__burger-line"})]}),!s&&Object(b.jsxs)("nav",{className:"header__nav-container appear ".concat(t&&!h?"header__nav-container_type_inactive":""," ").concat(h?"header__nav-container_type_column":""," "),children:[Object(b.jsx)("p",{className:"header__email",children:t?a:""}),r?Object(b.jsx)(o.c,{className:"header__nav-item",activeClassName:"header_nav-item_active",to:"/sign-up",children:t?"":"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}):Object(b.jsx)(o.c,{onClick:t?function(){n(),m(!1)}:function(){},className:"header__nav-item ".concat(u?"header__nav-item_active":""),to:"/sign-in",children:t?"\u0412\u044b\u0439\u0442\u0438":"\u0412\u043e\u0439\u0442\u0438"})]})]})};var j=function(e){var t=e.title,a=e.name,n=e.buttonSubmitText,c=e.children,s=e.isOpen,i=e.onClose,r=e.onSubmit,u=e.buttonSubmitState,p=e.isAuthForm,_=e.isToolTipForm,d=e.isSuccess,j="/sign-up"===Object(l.h)().pathname;return Object(b.jsx)("div",{className:"popup ".concat(p?"popup_type_auth appear":""," ").concat(s?"popup_opened":""),children:Object(b.jsxs)("div",{className:"popup__container ".concat(p?"popup__container_auth page__container":"popup__container_form"),children:[_&&Object(b.jsx)("div",{className:"popup__tooltip-image ".concat(d?"":"popup__tooltip-image_type_fail")}),Object(b.jsx)("h2",{className:"popup__title ".concat(_||p?"popup__title_place_auth":""),children:t}),!p&&Object(b.jsx)("button",{type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",className:"popup__btn-close ".concat(_?"popup__btn-close_place_tooltip":""),onClick:i}),Object(b.jsxs)("form",{className:"popup__form",name:"form-edit-".concat(a),onSubmit:r,noValidate:!0,children:[c,!_&&Object(b.jsx)("button",{type:"submit",className:"popup__btn-submit ".concat(p?"popup__btn-submit_type_auth":""," ").concat(u?"":"popup__btn-submit_inactive"),disabled:!u||"",children:n}),j&&!_&&Object(b.jsxs)("div",{className:"popup__auth-container",children:[Object(b.jsx)("p",{className:"popup__auth-text",children:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?\xa0"}),Object(b.jsx)(o.b,{className:"popup__auth-link",to:"/sign-in",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})]})})},h=c.a.memo((function(e){return e.isLoading&&Object(b.jsx)("div",{className:"cssload",children:Object(b.jsx)("div",{className:"cssload__whirlpool"})})}));var m=function(e){var t=e.isOpen,a=e.onLogin,n=e.buttonSubmitText,s=e.isLoading,i=c.a.useState(""),o=Object(p.a)(i,2),r=o[0],u=o[1],l=c.a.useState(""),_=Object(p.a)(l,2),d=_[0],m=_[1],O=c.a.useState(!0),f=Object(p.a)(O,2),v=f[0],x=f[1],g=c.a.useState(!0),S=Object(p.a)(g,2),N=S[0],k=S[1],y=c.a.useState(""),C=Object(p.a)(y,2),T=C[0],L=C[1],E=c.a.useState(""),U=Object(p.a)(E,2),I=U[0],w=U[1],A=c.a.useState(!1),P=Object(p.a)(A,2),R=P[0],D=P[1],M=c.a.useState(!0),q=Object(p.a)(M,2),z=q[0],F=q[1],J=c.a.useState(!0),H=Object(p.a)(J,2),B=H[0],G=H[1];return c.a.useEffect((function(){D(!1),x(!0),k(!0)}),[t]),c.a.useEffect((function(){D(!(!v||!N||z||B))}),[v,N,z,B]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(h,{isLoading:s}),!s&&Object(b.jsx)(j,{title:"\u0412\u0445\u043e\u0434",name:"login",buttonSubmitText:n,isOpen:t,onSubmit:function(e){e.preventDefault(),a({email:r,password:d})},buttonSubmitState:R,isAuthForm:!0,children:Object(b.jsxs)("fieldset",{className:"popup__set",children:[Object(b.jsxs)("label",{className:"popup__field",children:[Object(b.jsx)("input",{type:"email",name:"email",value:r,placeholder:"Email",className:"popup__input popup__input_type_auth ".concat(v?"":"popup__input_type_error"),required:!0,minLength:"2",maxLength:"40",onChange:function(e){var t;u(e.target.value),t=e.target,F(!1),t.validity.valid?x(!0):(x(!1),L(t.validationMessage))}}),Object(b.jsx)("span",{className:"popup__input-error ".concat(v?"":"popup__input-error_active"),children:T})]}),Object(b.jsxs)("label",{className:"popup__field",children:[Object(b.jsx)("input",{type:"password",name:"password",value:d,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",className:"popup__input popup__input_type_auth ".concat(N?"":"popup__input_type_error"),required:!0,minLength:"8",maxLength:"40",onChange:function(e){var t;m(e.target.value),t=e.target,G(!1),t.validity.valid?k(!0):(k(!1),w(t.validationMessage))}}),Object(b.jsx)("span",{className:"popup__input-error ".concat(N?"":"popup__input-error_active"),children:I})]})]})})]})};var O=function(e){var t=e.isOpen,a=e.onRegister,n=e.buttonSubmitText,s=c.a.useState(""),i=Object(p.a)(s,2),o=i[0],r=i[1],u=c.a.useState(""),l=Object(p.a)(u,2),_=l[0],d=l[1],h=c.a.useState(!0),m=Object(p.a)(h,2),O=m[0],f=m[1],v=c.a.useState(!0),x=Object(p.a)(v,2),g=x[0],S=x[1],N=c.a.useState(""),k=Object(p.a)(N,2),y=k[0],C=k[1],T=c.a.useState(""),L=Object(p.a)(T,2),E=L[0],U=L[1],I=c.a.useState(!1),w=Object(p.a)(I,2),A=w[0],P=w[1],R=c.a.useState(!0),D=Object(p.a)(R,2),M=D[0],q=D[1],z=c.a.useState(!0),F=Object(p.a)(z,2),J=F[0],H=F[1];return c.a.useEffect((function(){P(!1),f(!0),S(!0)}),[t]),c.a.useEffect((function(){P(!(!O||!g||M||J))}),[O,g,M,J]),Object(b.jsx)(j,{title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",name:"register",buttonSubmitText:n,isOpen:t,onSubmit:function(e){e.preventDefault(),a({email:o,password:_})},buttonSubmitState:A,isAuthForm:!0,children:Object(b.jsxs)("fieldset",{className:"popup__set",children:[Object(b.jsxs)("label",{className:"popup__field",children:[Object(b.jsx)("input",{type:"email",name:"email",value:o,placeholder:"Email",className:"popup__input popup__input_type_auth ".concat(O?"":"popup__input_type_error"),required:!0,minLength:"2",maxLength:"40",onChange:function(e){var t;r(e.target.value),t=e.target,q(!1),t.validity.valid?f(!0):(f(!1),C(t.validationMessage))}}),Object(b.jsx)("span",{className:"popup__input-error ".concat(O?"":"popup__input-error_active"),children:y})]}),Object(b.jsxs)("label",{className:"popup__field",children:[Object(b.jsx)("input",{type:"password",name:"password",value:_,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",className:"popup__input popup__input_type_auth ".concat(g?"":"popup__input_type_error"),required:!0,minLength:"8",maxLength:"40",onChange:function(e){var t;d(e.target.value),t=e.target,H(!1),t.validity.valid?S(!0):(S(!1),U(t.validationMessage))}}),Object(b.jsx)("span",{className:"popup__input-error ".concat(g?"":"popup__input-error_active"),children:E})]})]})})},f=c.a.createContext();var v=function(e){var t=e.card,a=e.onCardClick,n=e.onCardLike,s=e.onCardDelete,i=c.a.useContext(f),o=t.owner._id===i._id,r="cards__btn-remove ".concat(o?"cards__btn-remove_active":""),u=t.likes.some((function(e){return e._id===i._id})),p="cards__btn-like ".concat(u?"cards__btn-like_active appear":"");return Object(b.jsxs)("li",{className:"cards__item appear",children:[Object(b.jsx)("img",{className:"cards__image",src:"".concat(t.link),alt:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 ".concat(t.name),onClick:function(){a(t)}}),Object(b.jsx)("button",{type:"button","aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",className:r,onClick:function(){s(t)}}),Object(b.jsxs)("div",{className:"cards__description",children:[Object(b.jsx)("h2",{className:"cards__title text-cut",children:t.name}),Object(b.jsxs)("div",{className:"cards__likes-container",children:[Object(b.jsx)("button",{type:"button","aria-label":"\u041d\u0440\u0430\u0432\u0438\u0442\u0441\u044f",className:p,onClick:function(){n(t)}}),Object(b.jsx)("div",{className:"cards__likes-counter appear",children:t.likes.length})]})]})]})};var x=function(e){var t=e.onEditProfile,a=e.onAddPlace,n=e.onEditAvatar,s=e.onCardClick,i=e.cards,o=e.onCardLike,r=e.onCardDelete,u=c.a.useContext(f);return Object(b.jsxs)("main",{children:[Object(b.jsxs)("section",{className:"profile page__container",children:[Object(b.jsx)("div",{className:"profile__avatar appear",style:{backgroundImage:"url(".concat(u.avatar,")")},onClick:n}),Object(b.jsxs)("div",{className:"profile__info",children:[Object(b.jsxs)("div",{className:"profile__container",children:[Object(b.jsx)("h1",{className:"profile__name appear text-cut",children:u.name}),Object(b.jsx)("button",{type:"button","aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c",className:"profile__btn-edit",onClick:t})]}),Object(b.jsx)("p",{className:"profile__about appear text-cut",children:u.about})]}),Object(b.jsx)("button",{type:"button","aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",className:"profile__btn-add",onClick:a,children:" "})]}),Object(b.jsx)("section",{className:"places page__container",children:Object(b.jsx)("ul",{className:"cards",children:i.map((function(e){return Object(b.jsx)(v,{card:e,onCardClick:s,onCardLike:o,onCardDelete:r},e._id)}))})})]})},g=c.a.memo((function(e){return e.isLoggedIn&&Object(b.jsx)("footer",{className:"footer page__container",children:Object(b.jsx)("p",{className:"footer__author",children:"\xa9 2021 Mesto Russia"})})}));var S=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateUser,s=e.buttonSubmitText,i=c.a.useState("Name"),o=Object(p.a)(i,2),r=o[0],u=o[1],l=c.a.useState("About"),_=Object(p.a)(l,2),d=_[0],h=_[1],m=c.a.useState(!0),O=Object(p.a)(m,2),v=O[0],x=O[1],g=c.a.useState(!0),S=Object(p.a)(g,2),N=S[0],k=S[1],y=c.a.useState(""),C=Object(p.a)(y,2),T=C[0],L=C[1],E=c.a.useState(""),U=Object(p.a)(E,2),I=U[0],w=U[1],A=c.a.useState(!1),P=Object(p.a)(A,2),R=P[0],D=P[1],M=c.a.useContext(f);return c.a.useEffect((function(){M.name&&M.about&&(u(M.name),h(M.about)),x(!0),k(!0)}),[M,t]),c.a.useEffect((function(){D(!(!v||!N))}),[v,N]),Object(b.jsx)(j,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"profile",buttonSubmitText:s,isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n({name:r,about:d})},buttonSubmitState:R,children:Object(b.jsxs)("fieldset",{className:"popup__set",children:[Object(b.jsxs)("label",{className:"popup__field",children:[Object(b.jsx)("input",{type:"text",name:"name",value:r,placeholder:"\u0418\u043c\u044f",className:"popup__input ".concat(v?"":"popup__input_type_error"),required:!0,minLength:"2",maxLength:"40",onChange:function(e){var t;u(e.target.value),(t=e.target).validity.valid?x(!0):(x(!1),L(t.validationMessage))}}),Object(b.jsx)("span",{className:"popup__input-error ".concat(v?"":"popup__input-error_active"),children:T})]}),Object(b.jsxs)("label",{className:"popup__field",children:[Object(b.jsx)("input",{type:"text",name:"about",value:d,placeholder:"\u041e \u0441\u0435\u0431\u0435",className:"popup__input ".concat(N?"":"popup__input_type_error"),required:!0,minLength:"2",maxLength:"200",onChange:function(e){var t;h(e.target.value),(t=e.target).validity.valid?k(!0):(k(!1),w(t.validationMessage))}}),Object(b.jsx)("span",{className:"popup__input-error ".concat(N?"":"popup__input-error_active"),children:I})]})]})})};var N=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateAvatar,s=e.buttonSubmitText,i=c.a.useState(""),o=Object(p.a)(i,2),r=o[0],u=o[1],l=c.a.useState(!0),_=Object(p.a)(l,2),d=_[0],h=_[1],m=c.a.useState(""),O=Object(p.a)(m,2),f=O[0],v=O[1],x=c.a.useState(!1),g=Object(p.a)(x,2),S=g[0],N=g[1],k=c.a.useState(!0),y=Object(p.a)(k,2),C=y[0],T=y[1];return c.a.useEffect((function(){h(!0),N(!1),T(!0),u("")}),[t]),c.a.useEffect((function(){N(!(!d||C))}),[d,C]),Object(b.jsx)(j,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"avatar",buttonSubmitText:s,isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n({avatar:r})},buttonSubmitState:S,children:Object(b.jsx)("fieldset",{className:"popup__set",children:Object(b.jsxs)("label",{className:"popup__field",children:[Object(b.jsx)("input",{value:r,type:"url",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__input ".concat(d?"":"popup__input_type_error"),required:!0,onChange:function(e){u(e.target.value),e.target.validity.valid?(T(!1),h(!0)):(T(!1),h(!1),v(e.target.validationMessage))}}),Object(b.jsx)("span",{className:"popup__input-error ".concat(d?"":"popup__input-error_active"),children:f})]})})})};var k=function(e){var t=e.isOpen,a=e.onClose,n=e.onAddPlace,s=e.buttonSubmitText,i=c.a.useState(""),o=Object(p.a)(i,2),r=o[0],u=o[1],l=c.a.useState(""),_=Object(p.a)(l,2),d=_[0],h=_[1],m=c.a.useState(!0),O=Object(p.a)(m,2),f=O[0],v=O[1],x=c.a.useState(!0),g=Object(p.a)(x,2),S=g[0],N=g[1],k=c.a.useState(""),y=Object(p.a)(k,2),C=y[0],T=y[1],L=c.a.useState(""),E=Object(p.a)(L,2),U=E[0],I=E[1],w=c.a.useState(!1),A=Object(p.a)(w,2),P=A[0],R=A[1],D=c.a.useState(!0),M=Object(p.a)(D,2),q=M[0],z=M[1],F=c.a.useState(!0),J=Object(p.a)(F,2),H=J[0],B=J[1];return c.a.useEffect((function(){u(""),h(""),v(!0),N(!0),R(!1),z(!0),B(!0)}),[t]),c.a.useEffect((function(){R(!(!f||!S||q||H))}),[f,S,q,H]),Object(b.jsx)(j,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"card",buttonSubmitText:s,isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n({name:r,link:d})},buttonSubmitState:P,children:Object(b.jsxs)("fieldset",{className:"popup__set",children:[Object(b.jsxs)("label",{className:"popup__field",children:[Object(b.jsx)("input",{type:"text",name:"title",value:r,placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"popup__input ".concat(f?"":"popup__input_type_error"),required:!0,minLength:"2",maxLength:"30",onChange:function(e){var t;u(e.target.value),t=e.target,z(!1),t.validity.valid?v(!0):(v(!1),T(t.validationMessage))}}),Object(b.jsx)("span",{className:"popup__input-error ".concat(f?"":"popup__input-error_active"),children:C})]}),Object(b.jsxs)("label",{className:"popup__field",children:[Object(b.jsx)("input",{type:"url",name:"link",value:d,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__input ".concat(S?"":"popup__input_type_error"),required:!0,onChange:function(e){var t;h(e.target.value),t=e.target,B(!1),t.validity.valid?N(!0):(N(!1),I(t.validationMessage))}}),Object(b.jsx)("span",{className:"popup__input-error ".concat(S?"":"popup__input-error_active"),children:U})]})]})})};var y=function(e){var t=e.isOpen,a=e.onClose,n=e.card,c=e.onSubmitDelete,s=e.buttonSubmitText;return Object(b.jsx)(j,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"remove",buttonSubmitText:s,isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),c(n)},buttonSubmitState:"true"})};var C=function(e){var t=e.card,a=e.onClose;return Object(b.jsx)("div",{className:"popup popup_type_img ".concat(t.link?"popup_opened":""),children:Object(b.jsxs)("div",{className:"popup__container",children:[Object(b.jsx)("button",{type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",className:"popup__btn-close",onClick:a}),Object(b.jsxs)("figure",{className:"popup__figure",children:[Object(b.jsx)("img",{className:"popup__image",src:"".concat(t.link),alt:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 ".concat(t.name)}),Object(b.jsx)("figcaption",{className:"popup__caption",children:t.name})]})]})})};var T=function(e){var t=e.errorText,a=e.isActive;return Object(b.jsxs)("div",{className:"error-popup ".concat(a?"error-popup_opened":""," "),children:[Object(b.jsx)("h2",{className:"error-popup__title",children:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a..."}),Object(b.jsx)("p",{className:"error-popup__text",children:t})]})};var L=function(e){var t=e.isOpen,a=e.isSuccess,n=e.onClose,c=e.isToolTipForm;return Object(b.jsx)(j,{title:a?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437.",name:"infoToolTip",isOpen:t,onClose:n,isToolTipForm:c,isSuccess:a})},E=a(21),U=a(22),I=new(function(){function e(t){var a=t.baseUrl,n=t.groupId,c=t.token,s=t.authUrl;Object(E.a)(this,e),this._baseUrl=a,this._groupId=n,this._token=c,this._authUrl=s}return Object(U.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))}},{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/").concat(this._groupId,"/users/me"),{headers:{authorization:this._token}}).then(this._checkResponse)}},{key:"getCards",value:function(){return fetch("".concat(this._baseUrl,"/").concat(this._groupId,"/cards"),{headers:{authorization:this._token}}).then(this._checkResponse)}},{key:"setUserInfo",value:function(e){return fetch("".concat(this._baseUrl,"/").concat(this._groupId,"/users/me"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkResponse)}},{key:"postCard",value:function(e){return fetch("".concat(this._baseUrl,"/").concat(this._groupId,"/cards"),{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/").concat(this._groupId,"/cards/").concat(e._id),{method:"DELETE",headers:{authorization:this._token}}).then(this._checkResponse)}},{key:"changeLikeCardStatus",value:function(e,t){return fetch("".concat(this._baseUrl,"/").concat(this._groupId,"/cards/likes/").concat(e._id),{method:t?"PUT":"DELETE",headers:{authorization:this._token}}).then(this._checkResponse)}},{key:"getCountsOfLikes",value:function(e){return fetch("".concat(this._baseUrl,"/").concat(this._groupId,"/cards/likes/").concat(e._id),{headers:{authorization:this._token}}).then(this._checkResponse)}},{key:"changeAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/").concat(this._groupId,"/users/me/avatar"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then(this._checkResponse)}},{key:"register",value:function(e){var t=e.email,a=e.password;return fetch("".concat(this._authUrl,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:a,email:t})}).then(this._checkResponse)}},{key:"login",value:function(e){var t=e.email,a=e.password;return fetch("".concat(this._authUrl,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:a,email:t})}).then(this._checkResponse)}},{key:"checkToken",value:function(e){return fetch("".concat(this._authUrl,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(this._checkResponse)}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1",groupId:"cohort-22",token:"a835ebe3-157b-4140-922b-a5f49168fcac",authUrl:"https://auth.nomoreparties.co"}),w=a(23);var A=function(e){var t=e.component,a=Object(w.a)(e,["component"]);return Object(b.jsx)(l.b,{children:function(){return a.isLoggedIn?Object(b.jsx)(t,Object(u.a)({},a)):Object(b.jsx)(l.a,{to:"/sign-in"})}})};var P=function(){var e=c.a.useState(!1),t=Object(p.a)(e,2),a=t[0],n=t[1],s=c.a.useState(!1),i=Object(p.a)(s,2),o=i[0],_=i[1],j=c.a.useState(!1),h=Object(p.a)(j,2),v=h[0],E=h[1],U=c.a.useState(!1),w=Object(p.a)(U,2),P=w[0],R=w[1],D=c.a.useState(!1),M=Object(p.a)(D,2),q=M[0],z=M[1],F=c.a.useState(null),J=Object(p.a)(F,2),H=J[0],B=J[1],G=c.a.useState({}),V=Object(p.a)(G,2),K=V[0],Q=V[1],W=c.a.useState({errorText:"",isActive:!1}),X=Object(p.a)(W,2),Y=X[0],Z=X[1],$=c.a.useState({}),ee=Object(p.a)($,2),te=ee[0],ae=ee[1],ne=c.a.useState(""),ce=Object(p.a)(ne,2),se=ce[0],ie=ce[1],oe=c.a.useState(""),re=Object(p.a)(oe,2),ue=re[0],pe=re[1],le=c.a.useState([]),_e=Object(p.a)(le,2),be=_e[0],de=_e[1],je=c.a.useState("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),he=Object(p.a)(je,2),me=he[0],Oe=he[1],fe=c.a.useState("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),ve=Object(p.a)(fe,2),xe=ve[0],ge=ve[1],Se=c.a.useState("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),Ne=Object(p.a)(Se,2),ke=Ne[0],ye=Ne[1],Ce=c.a.useState("\u0414\u0430"),Te=Object(p.a)(Ce,2),Le=Te[0],Ee=Te[1],Ue=c.a.useState({}),Ie=Object(p.a)(Ue,2),we=Ie[0],Ae=Ie[1],Pe=c.a.useState(null),Re=Object(p.a)(Pe,2),De=Re[0],Me=Re[1],qe=c.a.useState(!1),ze=Object(p.a)(qe,2),Fe=ze[0],Je=ze[1],He=Object(l.g)(),Be=Object(l.h)();function Ge(e){return new Promise((function(t,a){var n=document.createElement("img");n.src=e,n.onload=t,n.onerror=a,n.remove()}))}function Ve(){Ke(),H&&Xe({email:se,password:ue})}function Ke(){n(!1),_(!1),E(!1),R(!1),z(!1),Q({}),Ae({})}function Qe(e,t){Z(Object(u.a)(Object(u.a)({},Y),{},{errorText:e,isActive:t}))}function We(){Je(!0);var e=localStorage.getItem("jwt");e?I.checkToken(e).then((function(e){ie(e.data.email),Me(!0),Je(!1),He.push("/")})).catch((function(){B(!1),z(!0)})):Je(!1)}function Xe(e){I.login(e).then((function(e){localStorage.setItem("jwt",e.token),We()})).catch((function(){B(!1),z(!0)}))}return c.a.useEffect((function(){We(),B(!1)}),[]),c.a.useEffect((function(){Promise.all([I.getUserInfo(),I.getCards()]).then((function(e){var t=Object(p.a)(e,2),a=t[0],n=t[1];ae(a),de(n)})).catch((function(e){Qe(e,!0),setTimeout((function(){return Qe(e,!1)}),5e3)}))}),[]),c.a.useEffect((function(){function e(e){e.target.classList.contains("popup")&&!e.target.classList.contains("popup_type_auth")&&(H?Ve():Ke())}return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[H]),c.a.useEffect((function(){function e(e){("Escape"===e.key&&(e.target.classList.contains("popup__btn-submit_type_auth")||e.target.classList.contains("popup__input_type_auth"))||"Escape"===e.key&&"/sign-up"!==Be.pathname&&"/sign-in"!==Be.pathname)&&(H?Ve():Ke())}return document.addEventListener("keyup",e),function(){document.removeEventListener("keyup",e)}}),[H,a,v,o,K]),Object(b.jsx)("div",{className:"page",children:Object(b.jsxs)(f.Provider,{value:te,children:[Object(b.jsx)(d,{isLoggedIn:De,userEmail:se,onSignOut:function(){Me(!1),He.push("/sign-in"),localStorage.removeItem("jwt"),ie(""),pe(""),B(null)},isLoading:Fe}),Object(b.jsxs)(l.d,{children:[Object(b.jsx)(A,{exact:!0,path:"/",component:x,isLoggedIn:De,onEditProfile:function(){Oe("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),_(!0)},onAddPlace:function(){ye("\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),E(!0)},onEditAvatar:function(){ge("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),n(!0)},onCardClick:function(e){Q(e)},cards:be,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===te._id}));I.changeLikeCardStatus(e,!t).then((function(t){de(be.map((function(a){return a._id===e._id?t:a})))})).catch((function(e){Qe(e,!0),setTimeout((function(){return Qe(e,!1)}),5e3)}))},onCardDelete:function(e){Ee("\u0414\u0430"),Ae(e),R(!0)}}),Object(b.jsx)(l.b,{path:"/sign-up",children:Object(b.jsx)(O,{isOpen:!0,onRegister:function(e){I.register(e).then((function(t){ie(t.data.email),pe(e.password),B(!0),z(!0)})).catch((function(){B(!1),z(!0)}))},buttonSubmitText:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})}),Object(b.jsx)(l.b,{path:"/sign-in",children:Object(b.jsx)(m,{isOpen:!0,onLogin:Xe,buttonSubmitText:"\u0412\u043e\u0439\u0442\u0438",isLoading:Fe})}),Object(b.jsx)(l.b,{children:Object(b.jsx)(l.a,{to:De?"/":"/sign-in"})})]}),Object(b.jsx)(g,{isLoggedIn:De}),Object(b.jsx)(S,{isOpen:o,onClose:Ke,onUpdateUser:function(e){Oe("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),I.setUserInfo(e).then((function(e){ae(Object(u.a)(Object(u.a)({},te),{},{name:e.name,about:e.about})),Ke()})).catch((function(e){Qe(e,!0),setTimeout((function(){return Qe(e,!1)}),5e3)}))},buttonSubmitText:me}),Object(b.jsx)(N,{isOpen:a,onClose:Ke,onUpdateAvatar:function(e){var t=e.avatar;Ge(t).then((function(){ge("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),I.changeAvatar(t).then((function(e){ae(Object(u.a)(Object(u.a)({},te),{},{avatar:e.avatar})),Ke()}))})).catch((function(){Qe("\u041e\u0448\u0438\u0431\u043a\u0430 \u0430\u0434\u0440\u0435\u0441\u0430",!0),setTimeout((function(){return Qe("\u041e\u0448\u0438\u0431\u043a\u0430 \u0430\u0434\u0440\u0435\u0441\u0430",!1)}),5e3)}))},buttonSubmitText:xe}),Object(b.jsx)(k,{isOpen:v,onClose:Ke,onAddPlace:function(e){Ge(e.link).then((function(){ye("\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435..."),I.postCard(e).then((function(e){de([e].concat(Object(r.a)(be))),Ke()}))})).catch((function(){Qe("\u041e\u0448\u0438\u0431\u043a\u0430 \u0430\u0434\u0440\u0435\u0441\u0430",!0),setTimeout((function(){return Qe("\u041e\u0448\u0438\u0431\u043a\u0430 \u0430\u0434\u0440\u0435\u0441\u0430",!1)}),5e3)}))},buttonSubmitText:ke}),Object(b.jsx)(y,{isOpen:P,card:we,onClose:Ke,onSubmitDelete:function(e){Ee("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."),I.deleteCard(e).then((function(){de(be.filter((function(t){return t._id!==e._id}))),Ke()})).catch((function(e){Qe(e,!0),setTimeout((function(){return Qe(e,!1)}),5e3)}))},buttonSubmitText:Le}),Object(b.jsx)(C,{card:K,onClose:Ke}),Object(b.jsx)(T,{errorText:Y.errorText,isActive:Y.isActive}),Object(b.jsx)(L,{isOpen:q,onClose:Ve,isSuccess:H,isToolTipForm:!0})]})})};i.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(o.a,{children:Object(b.jsx)(P,{})})}),document.querySelector(".root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.9e4cd99e.chunk.js.map